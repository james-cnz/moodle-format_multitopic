define("format_multitopic/courseformat/courseindex/section",["exports","core_courseformat/local/courseindex/section"],(function(_exports,_section){var obj;
/**
   * Course index section component.
   *
   * This component is used to control specific course section interactions like drag and drop.
   *
   * @module     format_multitopic/courseformat/courseindex/section
   * @class      format_multitopic/courseformat/courseindex/section
   * @copyright  2022 onwards James Calder and Otago Polytechnic
   * @copyright  based on work by 2021 Ferran Recio <ferran@moodle.com>
   * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later
   */Object.defineProperty(_exports,"__esModule",{value:!0}),_exports.default=void 0,_section=(obj=_section)&&obj.__esModule?obj:{default:obj};class Component extends _section.default{static init(target,selectors){return new this({element:document.querySelector(target),selectors:selectors})}_refreshSection(param){super._refreshSection(param);const element=param.element;this.element.querySelector(":scope > .courseindex-item a.courseindex-link").href=element.sectionurl,element.component||(this.getElement(this.selectors.SECTION_TITLE).innerHTML=element.shorttitle,this.element.dataset.indent!=element.indent&&(this.element.querySelector(":scope > .courseindex-item").style="padding-left: "+element.indent+"em;",this.element.querySelector(":scope > .courseindex-item-content > .courseindex-sectioncontent").style="padding-left: "+element.indent+"em;",this.element.dataset.indent=element.indent))}validateDropData(dropdata){if("section"===(null==dropdata?void 0:dropdata.type)){if(null!==this.section.component)return!1;const sectionzeroid=this.course.sectionlist[0],origin=this.reactive.get("section",dropdata.id);return this.section.indent<=origin.indent&&origin.id!=sectionzeroid}return super.validateDropData(dropdata)}showDropZone(dropdata){if("section"==dropdata.type){const origin=this.reactive.get("section",dropdata.id);let target=this.section;for(;target.indent>origin.indent;)target=this.reactive.get("section",this.course.sectionlist[target.number-1]);const moveDirection=target.number!=origin.number,targetContentDom=this.element.querySelector(".courseindex-item-content");let targetShow=target,targetShowBorder=moveDirection;if(moveDirection>0&&targetContentDom.classList.contains("show")){let targetChild=target;for(;this.course.sectionlist.length>targetChild.number+1&&this.reactive.get("section",this.course.sectionlist[targetChild.number+1]).indent>target.indent;)if(targetChild=this.reactive.get("section",this.course.sectionlist[targetChild.number+1]),targetChild.indent<=origin.indent){targetShow=targetChild,targetShowBorder=-1;break}}const targetShowDom=document.querySelector(".courseindex-section[data-id='"+targetShow.id+"']");targetShowBorder>0?targetShowDom.classList.add(this.classes.DROPDOWN):targetShowBorder<0&&targetShowDom.classList.add(this.classes.DROPUP)}else super.showDropZone(dropdata)}hideDropZone(dropdata){if("section"==dropdata.type){const origin=this.reactive.get("section",dropdata.id);let target=this.section;for(;target.indent>origin.indent;)target=this.reactive.get("section",this.course.sectionlist[target.number-1]);const moveDirection=target.number!=origin.number,targetContentDom=this.element.querySelector(".courseindex-item-content");let targetShow=target,targetShowBorder=moveDirection;if(moveDirection>0&&targetContentDom.classList.contains("show")){let targetChild=target;for(;this.course.sectionlist.length>targetChild.number+1&&this.reactive.get("section",this.course.sectionlist[targetChild.number+1]).indent>target.indent;)if(targetChild=this.reactive.get("section",this.course.sectionlist[targetChild.number+1]),targetChild.indent<=origin.indent){targetShow=targetChild,targetShowBorder=-1;break}}const targetShowDom=document.querySelector(".courseindex-section[data-id='"+targetShow.id+"']");targetShowBorder>0?targetShowDom.classList.remove(this.classes.DROPDOWN):targetShowBorder<0&&targetShowDom.classList.remove(this.classes.DROPUP)}else super.hideDropZone(dropdata)}drop(dropdata,event){if("section"==dropdata.type){const origin=this.reactive.get("section",dropdata.id);let target=this.section;for(;target.indent>origin.indent;)target=this.reactive.get("section",this.course.sectionlist[target.number-1]);const moveDirection=target.number!=origin.number,targetContentDom=this.element.querySelector(".courseindex-item-content");let targetCall=target;if(moveDirection>0&&!targetContentDom.classList.contains("show")){let targetChild=target;for(;this.course.sectionlist.length>targetChild.number+1&&this.reactive.get("section",this.course.sectionlist[targetChild.number+1]).indent>target.indent;)targetChild=this.reactive.get("section",this.course.sectionlist[targetChild.number+1]),targetChild.indent<=origin.indent&&(targetCall=targetChild)}moveDirection>0&&this.reactive.dispatch("sectionMoveAfter",[origin.id],targetCall.id)}else super.drop(dropdata,event)}}return _exports.default=Component,_exports.default}));

//# sourceMappingURL=section.min.js.map